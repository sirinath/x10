/*
 *
 * (C) Copyright IBM Corporation 2006
 *
 *  This file is part of X10 Test.
 *
 */
import x10.lang.Object;
import harness.x10Test;;

/**
*  Implementing a 5-point stencil operation using for loop
* @author Tong
  11/29/2006
*/
public class StencilFor2D_Dep extends x10Test {
	
        public def run(): boolean = {
        	val R: region{rank==2} = [-1..256, -1..256];
                val r: region{rank==2} = [0..255, 0..255];
        	//final point(:rank==2) north=[0,1], south=[0,-1], west=[-1,0], east=[1,0];
        	val north: point = [0, 1];
                val south: point = [0, -1];
                val west: point = [-1, 0];
                val east: point = [1, 0];//the rank is not a property of point
        	val D: dist{rank==2} = R->here;
        	//final double [:rank==2] A=new double [R]; //this statement should work.
        	final val A: Array[double]{rank==2} = new Array[double](D);
        	final val h: double = 0.1;
        	
        	for (val p: point in r) A(p)=(A(p+north)+A(p+south)+A(p+west)+A(p+east)-4*A(p))*h;
        	
	    return true;
	}
	
	public static def main(var args: Rail[String]): void = {
		new StencilFor2D_Dep().execute();
	}

}
