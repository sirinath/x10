<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project [<!ENTITY buildfile SYSTEM "file:./build-user.xml">]>
<!-- WARNING: Eclipse autogenerated file.
              Any modifications will be overwritten.
              Please edit build-user.xml instead.
-->
<project name="x10.compiler" default="build" basedir=".">
    &buildfile;
    <property name="container_loc" value="."/>
    <property name="lpg.location" value="../lpg"/>
    <property name="pe.location" value="../pe"/>
    <property name="polyglot.location" value="../polyglot2"/>
    <property name="resource_loc" value="../x10.compiler"/>
    <property name="workspace_loc:x10.common" value="../x10.common"/>
    <property name="x10.common.location" value="../x10.common"/>
    <property name="x10.runtime.location" value="../x10.runtime"/>
    <path id="project.classpath">
        <path refid="mainproject.classpath"/>
        <path refid="lpg.classpath"/>
        <path refid="pe.classpath"/>
        <path refid="polyglot.classpath"/>
        <path refid="x10.common.classpath"/>
        <path refid="x10.runtime.classpath"/>
    </path>
    <path id="mainproject.classpath">
        <pathelement location="classes"/>
    </path>
    <path id="lpg.classpath">
        <pathelement location="${lpg.location}/lib/lpg.jar"/>
    </path>
    <path id="pe.classpath">
        <pathelement location="${pe.location}/classes"/>
        <pathelement location="${pe.location}/lib/PE.jar"/>
    </path>
    <path id="polyglot.classpath">
        <pathelement location="${polyglot.location}/bin"/>
    </path>
    <path id="x10.common.classpath"/>
    <path id="x10.runtime.classpath">
        <pathelement location="${x10.runtime.location}/classes"/>
    </path>
    <target name="init">
        <mkdir dir="classes"/>
    </target>
    <target name="clean">
        <delete dir="classes"/>
    </target>
    <target name="build" depends="init">
        <ant antfile="${lpg.location}/build.xml" inheritAll="false"/>
        <ant antfile="${pe.location}/build.xml" inheritAll="false"/>
        <ant antfile="${polyglot.location}/build.xml" inheritAll="false"/>
        <ant antfile="${x10.common.location}/build.xml" inheritAll="false"/>
        <ant antfile="${x10.runtime.location}/build.xml" inheritAll="false"/>
        <echo message="${ant.project.name}: ${ant.file}"/>
        <javac destdir="classes" source="1.4" target="1.4">
            <src path="src"/>
            <classpath refid="project.classpath"/>
        </javac>
    </target>
    <target name="grammar" depends="init">
        <property name="grammar.file" location="${resource_loc}/src/x10/parser/x10-feb2005.g"/>
        <property name="include.dir" location="${lpg.location}/templates"/>
        <condition property="platform" value="win32"><os family="windows"/></condition>
        <condition property="platform" value="linux"><os name="Linux"/></condition>
        <property name="lpg.executable" location="${lpg.location}/bin/lpg-${platform}_${os.arch}"/>
        <!--
        <echo message="OS: ${os.name} ${os.arch}"/>
        <echo message="Platform: ${platform}"/>
        <echo message="LPG: ${lpg.executable}"/>
        <echo>
            dir="${basedir}/src/x10/parser" executable="${lpg.executable}"
            "-include-directory=${include.dir}"
            "${grammar.file}"
        </echo>
        -->
        <exec dir="${basedir}/src/x10/parser" executable="${lpg.executable}"
              failonerror="true">
            <arg value="-include-directory=${include.dir}"/>
            <arg value="${grammar.file}"/>
        </exec>
    </target>
    <target name="rebuild" depends="grammar,build"/>
</project>
