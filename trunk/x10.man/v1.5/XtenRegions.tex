\section{Regions}\label{XtenRegions}\index{region}

A region is a set of indices (called {\em points}).  {}\Xten{}
provides a built-in value class, {\tt x10.lang.region}, to allow the
creation of new regions and to perform operations on regions. This
class is {\tt final} in {}\XtenCurrVer; future versions of the
language may permit user-definable regions. Since regions play a dual
role (values as well as types), variables of type \xcd"region" must be
initialized and are implicitly {\tt final}. Regions are first-class
objects---they may be stored in fields of objects, passed as
arguments to methods, returned from methods etc.

Each region \xcd"R" has a constant rank, \xcd"R.rank", which is a
non-negative integer. The literal \xcd"[]" represents the {\em empty
region} and has rank \xcd"0".

Here are several examples of region declarations:
\begin{xten}
Null: region = [];  // Empty 0-dimensional region          
R1: region = 1:100; // 1-dim region with extent 1..100.
R1: region = [1:100]; // Same as above.
R2: region = [0:99, -1:MAX_HEIGHT];   
R3: region = region.factory.upperTriangular(N);
R4: region = region.factory.banded(N, K);
   // A square region.
R5: region = [E, E];           
   // Same as: region above.
R6: region = [100, 100];       
   // Represents the intersection of two regions
AandB: region = A && B;       
  // represents the union of two regions
AOrB: region = A || B;        
\end{xten}

A region may be constructed using a comma-separated list of regions
(\S~\ref{point-syntax}) within square brackets, as above and represents
the Cartesian product of each of the arguments.  The bound of a
dimension may be any final variable of a fixed-point numeric
type. \XtenCurrVer{} does not support hierarchical regions.

Various built-in regions are provided through  factory
methods on {\tt region}.  For instance:\index{region!upperTriangular}
\index{region!lowerTriangular}\index{region!banded}
\begin{itemize}
{}\item \xcd"region.factory.upperTriangular(N)" returns a region corresponding
to the non-zero indices in an upper-triangular \xcd"N x N" matrix.
{}\item \xcd"region.factory.lowerTriangular(N)" returns a region corresponding
to the non-zero indices in a lower-triangular \xcd"N x N" matrix.
{}\item \xcd"region.banded(N, K)" returns a region corresponding to
the non-zero indices in a banded \xcd"N x N" matrix where the width of
the band is \xcd"K"
\end{itemize}

All the points in a region are ordered canonically by the lexicographic total order. Thus the points of a region \xcd"R=[1:2,1:2]" are ordered as 
\begin{xten}
(1,1), (1,2), (2,1), (2,2)
\end{xten}
Sequential iteration statements such as \xcd"for" (\S~\ref{ForAllLoop})
iterate over the points in a region in the canonical order.

A region is said to be {\em convex}\index{region!convex} if it is of
the form \xcd"[T1,..., Tk]" for some set of enumerations \xcd"Ti". Such a
region satisfies the property that if two points $p_1$ and $p_3$ are
in the region, then so is every point $p_2$ between them. (Note that
\xcd"||" may produce non-convex regions from convex regions, e.g.{}
\xcd"[1,1] || [3,3]" is a non-convex region.)

For each region \xcd"R", the {\em convex closure} of \xcd"R" is the
smallest convex region enclosing \xcd"R".  For each integer \xcd"i"
less than \xcd"R.rank", the term \xcd"R[i]" represents the enumeration
in the \xcd"i"th dimension of the convex closure of \xcd"R". It may be
used in a type expression wherever an enumeration may be used.

\subsection{Operations on regions}
Various non side-effecting operators (i.e.{} pure functions) are
provided on regions. These allow the programmer to express sparse as
well as dense regions.

Let \xcd"R" be a region. A subset of \xcd"R" is also called a {\em
sub-region}.\index{region!sub-region}

Let \xcd"R1" and \xcd"R2" be two regions.

\xcd"R1 && R2" is the intersection of \xcd"R1" and \xcd"R2".\index{region!intersection}

\xcd"R1 || R2" is the union of the \xcd"R1" and \xcd"R2".\index{region!union}

\xcd"R1 - R2" is the set difference of \xcd"R1" and \xcd"R2".\index{region!set difference}

Two regions are equal ({\tt ==}) if they represent the same set of
points.\index{region!==}


\todo{ Need to determine if regions can be passed to and returned from
methods.}

\todo{Can objects have region fields?}

\todo{ Need to determine if Xten control constructs already provide the nesting of regions of ZPL.}

\todo{ Need to determine if directions (and "of", wrap, reflect) make sense and should be included in Xten.}

\todo{ Need to add translations (ZPL @). Check whether they are widely useful.}

\todo{ Need to determine if {\tt index<d>} arrays are useful enough to include them.}



