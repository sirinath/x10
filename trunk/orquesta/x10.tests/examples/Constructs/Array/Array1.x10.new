/*
 *
 * (C) Copyright IBM Corporation 2006
 *
 *  This file is part of X10 Test.
 *
 */
import harness.x10Test;;

/**
 * Simple array test.
 *
 * Only uses the longhand forms such as ia.get(p) for ia[p].
 * Note: this a test only.  It is not the recommended way to
 * write x10 code.
 */
public class Array1 extends x10Test {

	public def run(): boolean = {
		var e: region = region.factory.region(1, 10);
		var r: region = region.factory.region(new Array[region] {e, e});
		var d: dist = r->here;
		var ia: Array[int] = new Array[int](d);

		for (val p: point in e) for (val q: point in e) {
				var i: int = p.get(0);
				var j: int = q.get(0);
				chk(ia.get(i,j) == 0);
				ia.set(i+j, i, j);
			}

		for (val p: point in d) {
			var i: int = p.get(0);
			var j: int = p.get(1);
			var q1: point = point.factory.point(new Array[int] {i, j});
			chk(i == q1.get(0));
			chk(j == q1.get(1));
			chk(ia.get(i, j) == i+j);
			chk(ia.get(i, j) == ia.get(p));
			chk(ia.get(q1) == ia.get(p));
			ia.set(ia.get(p)-1, p);
			chk(ia.get(p) == i+j-1);
			chk(ia.get(q1) == ia.get(p));
		}

		return true;
	}

	public static def main(var args: Rail[String]): void = {
		new Array1().execute();
	}
}
