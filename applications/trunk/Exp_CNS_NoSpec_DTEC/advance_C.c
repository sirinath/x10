/***********************************************************************************/
/* This version is a directly translated from advance.f90                          */
/* Majority of the translation is done by the Fortran_to_C tool inside ROSE.       */
/* Minor manual translation is required to address features from Fortran 90.       */
/* All arrays are linearized single-dimensional arrays in C                        */
/***********************************************************************************/


#define min(a,b) (((a)<(b))?(a):(b))
#define max(a,b) (((a)>(b))?(a):(b))
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <float.h>
void ctoprim_(int *lo,int *hi,int *ng,double *u,double *q,double *dx,double *courno)
{
  int i;
  int j;
  int k;
  double c;
  double eint;
  double courx;
  double coury;
  double courz;
  double courmx;
  double courmy;
  double courmz;
  double rhoinv;
  double dx1inv;
  double dx2inv;
  double dx3inv;
  double CVinv;
  double GAMMA = 1.4e0;
  double CV = 8.3333333333e6;
  //printf("Running ctoprim in C version !!\n");
/* !    type(bl_prof_timer), save :: bpt_ctoprim, bpt_ctoprim_loop1, bpt_ctoprim_loop2 */
/* !    call build(bpt_ctoprim, "bpt_ctoprim") */
  CVinv = 1.0e0 / CV;
/* !    call build(bpt_ctoprim_loop1, "bpt_ctoprim_loop1") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,eint,rhoinv) */
  for (k = lo[3 - 1] -  *ng; k <= hi[3 - 1] +  *ng; k = k + 1) {
    for (j = lo[2 - 1] -  *ng; j <= hi[2 - 1] +  *ng; j = j + 1) {
      for (i = lo[1 - 1] -  *ng; i <= hi[1 - 1] +  *ng; i = i + 1) {
        rhoinv = 1.0e0 / u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (1 - 1)))];
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (1 - 1)))] = u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (1 - 1)))];
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (2 - 1)))] = u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (2 - 1)))] * rhoinv;
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (3 - 1)))] = u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (3 - 1)))] * rhoinv;
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (4 - 1)))] = u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (4 - 1)))] * rhoinv;
        eint = u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (5 - 1)))] * rhoinv - 0.5e0 * (pow(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (2 - 1)))],2.0) + pow(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (3 - 1)))],2.0) + pow(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (4 - 1)))],2.0));
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (5 - 1)))] = (GAMMA - 1.e0) * eint * u[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (1 - 1)))];
        q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (6 - 1)))] = eint * CVinv;
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_ctoprim_loop1) */
//  if (present( *courno)) {
  if (*courno != 0.0) {
    courmx = -DBL_MAX;
    courmy = -DBL_MAX;
    courmz = -DBL_MAX;
    dx1inv = 1.0e0 / dx[1 - 1];
    dx2inv = 1.0e0 / dx[2 - 1];
    dx3inv = 1.0e0 / dx[3 - 1];
/* !       call build(bpt_ctoprim_loop2, "bpt_ctoprim_loop2") */
/*        !$OMP PARALLEL DO PRIVATE(i,j,k,c,courx,coury,courz) REDUCTION(max:courmx,courmy,courmz) */
    for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
      for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
        for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
          c = sqrt(GAMMA * q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (5 - 1)))] / q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (1 - 1)))]);
          courx = (c + fabs(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (2 - 1)))])) * dx1inv;
          coury = (c + fabs(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (3 - 1)))])) * dx2inv;
          courz = (c + fabs(q[i - (lo[1 - 1] -  *ng) + (hi[1 - 1] +  *ng - (lo[1 - 1] -  *ng) + 1) * (j - (lo[2 - 1] -  *ng) + (hi[2 - 1] +  *ng - (lo[2 - 1] -  *ng) + 1) * (k - (lo[3 - 1] -  *ng) + (hi[3 - 1] +  *ng - (lo[3 - 1] -  *ng) + 1) * (4 - 1)))])) * dx3inv;
          courmx = (courmx > courx?courmx : courx);
          courmy = (courmy > coury?courmy : coury);
          courmz = (courmz > courz?courmz : courz);
        }
      }
    }
/*        !$OMP END PARALLEL DO */
/* !       call destroy(bpt_ctoprim_loop2) */
/*        ! */
/*        ! Compute running max of Courant number over grids. */
/*        ! */
/* !       courno = max( courmx, courmy, courmz , courno ) */
  *courno = max( max( max(courmx, courmy), courmz), *courno);
  }
  else {
  }
/* !    call destroy(bpt_ctoprim) */
}

void hypterm_(int *lo,int *hi,int *ng,double *dx,double *cons,double *q,double *flux)
{
  int irho = 1;
  int imx = 2;
  int imy = 3;
  int imz = 4;
  int iene = 5;
  int qu = 2;
  int qv = 3;
  int qw = 4;
  int qpres = 5;
  double ALP = 0.8e0;
  double BET = - 0.2e0;
  double GAM = 4.e0 / 105.e0;
  double DEL = -(1.e0 / 280.e0);
  int i;
  int j;
  int k;
  double unp1;
  double unp2;
  double unp3;
  double unp4;
  double unm1;
  double unm2;
  double unm3;
  double unm4;
  double dxinv[3];
  //printf("Running hypterm in C version !!\n");
/* !    type(bl_prof_timer), save :: bpt_hypterm, bpt_hypterm_loop1, bpt_hypterm_loop2, bpt_hypterm_loop3 */
/* !    call build(bpt_hypterm, "bpt_hypterm") */
  for (i = 1; i <= 3; i = i + 1) {
    dxinv[i - 1] = 1.0e0 / dx[i - 1];
  }
/* !    call build(bpt_hypterm_loop1, "bpt_hypterm_loop1") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,unp1,unp2,unp3,unp4,unm1,unm2,unm3,unm4) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        unp1 = q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unp2 = q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unp3 = q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unp4 = q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unm1 = q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unm2 = q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unm3 = q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        unm4 = q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] = -((ALP * (cons[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] - cons[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))]) + BET * (cons[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] - cons[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng)\
 + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))]) + GAM * (cons[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] - cons[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))]) + DEL * (cons[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] - cons[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - \
1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))])) * dxinv[1 - 1]);
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] = -((ALP * (cons[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp1 - cons[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm1 + (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng\
) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + BET * (cons[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp2 - cons[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm2 + (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - 2 - (-( *ng) + lo[1 - 1]) + (\
hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + GAM * (cons[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp3 - cons[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm3 + (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - 3\
 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + DEL * (cons[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp4 - cons[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm4 + (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1)\
 * (qpres - 1)))] - q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))]))) * dxinv[1 - 1]);
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] = -((ALP * (cons[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp1 - cons[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm1) + BET * (cons[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp2 - cons[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1\
] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm2) + GAM * (cons[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp3 - cons[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm3) + DEL * (cons[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp4\
 - cons[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm4)) * dxinv[1 - 1]);
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] = -((ALP * (cons[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp1 - cons[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm1) + BET * (cons[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp2 - cons[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1\
] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm2) + GAM * (cons[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp3 - cons[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm3) + DEL * (cons[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp4\
 - cons[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm4)) * dxinv[1 - 1]);
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] = -((ALP * (cons[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp1 - cons[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm1 + (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp1 - q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm1)) + BET * (cons[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp2 - cons[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm2 + (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp2 - q[i - 2\
 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm2)) + GAM * (cons[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp3 - cons[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm3 + (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qpres - 1)))] * unp3 - q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm3)) + DEL * (cons[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp4 - cons[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm4 + (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]\
) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp4 - q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm4))) * dxinv[1 - 1]);
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_hypterm_loop1) */
/* !    call build(bpt_hypterm_loop2, "bpt_hypterm_loop2") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,unp1,unp2,unp3,unp4,unm1,unm2,unm3,unm4) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        unp1 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unp2 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unp3 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unp4 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unm1 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unm2 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unm3 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        unm4 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))]) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * \
(k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))]) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))]) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng)\
 + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))])) * dxinv[2 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm1) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2\
 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm2) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm3) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + \
lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm4)) * dxinv[2 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm1 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1)\
 * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm2 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - \
(-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm3 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - \
1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm4 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (\
j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))]))) * dxinv[2 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm1) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2\
 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm2) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm3) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + \
lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm4)) * dxinv[2 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm1 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1])\
 + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp1 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm1)) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm2 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1])\
 + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp2 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm2)) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm3 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1\
 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp3 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm3)) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm4 + (q[i - (-( *ng) + lo[1\
 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp4 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm4))) * dxinv[2 - 1];
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_hypterm_loop2) */
/* !    call build(bpt_hypterm_loop3, "bpt_hypterm_loop3") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,unp1,unp2,unp3,unp4,unm1,unm2,unm3,unm4) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        unp1 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unp2 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unp3 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unp4 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unm1 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unm2 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unm3 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        unm4 = q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))]) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k\
 + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))]) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))]) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + \
lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))])) * dxinv[3 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm1) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1])\
 + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm2) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm3) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2\
 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imx - 1)))] * unm4)) * dxinv[3 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm1) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1])\
 + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm2) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm3) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2\
 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imy - 1)))] * unm4)) * dxinv[3 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm1 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k\
 + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm2 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *\
ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm3 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1])\
 + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))])) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (imz - 1)))] * unm4 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * \
(j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))]))) * dxinv[3 - 1];
        flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] = flux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] - (ALP * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp1 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm1 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1)\
 * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp1 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm1)) + BET * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp2 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm2 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[\
2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp2 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm2)) + GAM * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp3 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm3 + (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]\
) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp3 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm3)) + DEL * (cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unp4 - cons[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (iene - 1)))] * unm4 + (q[i - (-( *ng) + lo[1 - 1])\
 + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unp4 - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qpres - 1)))] * unm4))) * dxinv[3 - 1];
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_hypterm_loop3) */
/* !    call destroy(bpt_hypterm) */
}

void diffterm_(int *lo,int *hi,int *ng,double *dx,double *q,double *difflux,double *eta,double *alam)
{
  int irho = 1;
  int imx = 2;
  int imy = 3;
  int imz = 4;
  int iene = 5;
  int qu = 2;
  int qv = 3;
  int qw = 4;
  double ALP = 0.8e0;
  double BET = - 0.2e0;
  double GAM = 4.e0 / 105.e0;
  double DEL = -(1.e0 / 280.e0);
/* !    double precision, allocatable, dimension(:,:,:) :: ux,uy,uz,vx,vy,vz,wx,wy,wz */
  double *ux = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *uy = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *uz = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *vx = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *vy = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *vz = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *wx = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *wy = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double *wz = (double*) malloc(sizeof(double)*(hi[1 - 1] + *ng - (-*ng + lo[1 - 1]) + 1) * (hi[2 - 1] + *ng - (-*ng + lo[2 - 1]) + 1) * (hi[3 - 1] + *ng - (-*ng + lo[3 - 1]) + 1));
  double dxinv[3];
  double tauxx;
  double tauyy;
  double tauzz;
  double tauxy;
  double tauxz;
  double tauyz;
  double divu;
  double uxx;
  double uyy;
  double uzz;
  double vxx;
  double vyy;
  double vzz;
  double wxx;
  double wyy;
  double wzz;
  double txx;
  double tyy;
  double tzz;
  double mechwork;
  double uxy;
  double uxz;
  double vyz;
  double wzx;
  double wzy;
  double vyx;
  int i;
  int j;
  int k;
  double OneThird = 1.0e0 / 3.0e0;
  double TwoThirds = 2.0e0 / 3.0e0;
  double FourThirds = 4.0e0 / 3.0e0;
  double CENTER = -(205.e0 / 72.e0);
  double OFF1 = 8.e0 / 5.e0;
  double OFF2 = - 0.2e0;
  double OFF3 = 8.e0 / 315.e0;
  double OFF4 = -(1.e0 / 560.e0);
  //printf("Running diffterm in C version !!\n");
/* !    type(bl_prof_timer), save :: bpt_hypterm, bpt_hypterm_loop1, bpt_hypterm_loop2, bpt_hypterm_loop3 */
/* !    type(bl_prof_timer), save :: bpt_diffterm, bpt_diffterm_loop123, bpt_diffterm_loop4 */
/* !    type(bl_prof_timer), save :: bpt_diffterm_loop5, bpt_diffterm_loop6, bpt_diffterm_loop7 */
/* !    call build(bpt_diffterm, "bpt_diffterm") */
/* !    difflux(:,:,:,irho) = 0.0d0 */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) 
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) 
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1)
        difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (irho - 1)))] =  0.0e0;
 
  for (i = 1; i <= 3; i = i + 1) {
    dxinv[i - 1] = 1.0e0 / dx[i - 1];
  }
/* !    call build(bpt_diffterm_loop123, "bpt_diffterm_loop123") */
/*     !$OMP PARALLEL PRIVATE(i,j,k) */
/*     !$OMP DO */
  for (k = lo[3 - 1] -  *ng; k <= hi[3 - 1] +  *ng; k = k + 1) {
    for (j = lo[2 - 1] -  *ng; j <= hi[2 - 1] +  *ng; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + BET * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + GAM * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + DEL * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] + \
 *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * dxinv[1 - 1];
        vx[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + BET * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + GAM * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + DEL * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] + \
 *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * dxinv[1 - 1];
        wx[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + BET * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + GAM * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + DEL * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] + \
 *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * dxinv[1 - 1];
      }
    }
  }
/*     !$OMP END DO NOWAIT */
/*     !$OMP DO */
  for (k = lo[3 - 1] -  *ng; k <= hi[3 - 1] +  *ng; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1] -  *ng; i <= hi[1 - 1] +  *ng; i = i + 1) {
        uy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * dxinv[2 - 1];
        vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * dxinv[2 - 1];
        wy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * dxinv[2 - 1];
      }
    }
  }
/*     !$OMP END DO NOWAIT */
/*     !$OMP DO */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1] -  *ng; j <= hi[2 - 1] +  *ng; j = j + 1) {
      for (i = lo[1 - 1] -  *ng; i <= hi[1 - 1] +  *ng; i = i + 1) {
        uz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * dxinv[3 - 1];
        vz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * dxinv[3 - 1];
        wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] = (ALP * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + BET * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (\
-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + GAM * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + DEL * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] - q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng\
 - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * dxinv[3 - 1];
      }
    }
  }
/*     !$OMP END DO */
/*     !$OMP END PARALLEL */
/* !    call destroy(bpt_diffterm_loop123) */
/* !    call build(bpt_diffterm_loop4, "bpt_diffterm_loop4") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,uxx,uyy,uzz,vyx,wzx) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        uxx = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + OFF1 * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF2 * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qu - 1)))] + q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF3 * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF4 * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qu - 1)))] + q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * pow(dxinv[1 - 1],2.0);
        uyy = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * pow(dxinv[2 - 1],2.0);
        uzz = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qu - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))])) * pow(dxinv[3 - 1],2.0);
        vyx = (ALP * (vy[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - vy[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + BET * (vy[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - vy[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + GAM * (vy[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - vy[i - 3 - (-( *\
ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + DEL * (vy[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - vy[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))])) * dxinv[1 - 1];
        wzx = (ALP * (wz[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + BET * (wz[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + GAM * (wz[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - 3 - (-( *\
ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + DEL * (wz[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))])) * dxinv[1 - 1];
        difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] =  *eta * (FourThirds * uxx + uyy + uzz + OneThird * (vyx + wzx));
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_diffterm_loop4) */
/* ! */
/* !    call build(bpt_diffterm_loop5, "bpt_diffterm_loop5") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,vxx,vyy,vzz,uxy,wzy) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        vxx = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + OFF1 * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF2 * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qv - 1)))] + q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF3 * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF4 * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qv - 1)))] + q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * pow(dxinv[1 - 1],2.0);
        vyy = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * pow(dxinv[2 - 1],2.0);
        vzz = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qv - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))])) * pow(dxinv[3 - 1],2.0);
        uxy = (ALP * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + BET * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + GAM * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng)\
 + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + DEL * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))])) * dxinv[2 - 1];
        wzy = (ALP * (wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + BET * (wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + GAM * (wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - (-( *ng)\
 + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]) + DEL * (wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))])) * dxinv[2 - 1];
        difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] =  *eta * (vxx + FourThirds * vyy + vzz + OneThird * (uxy + wzy));
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_diffterm_loop5) */
/* ! */
/* !    call build(bpt_diffterm_loop6, "bpt_diffterm_loop6") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,wxx,wyy,wzz,uxz,vyz) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        wxx = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + OFF1 * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF2 * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qw - 1)))] + q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF3 * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF4 * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qw - 1)))] + q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * pow(dxinv[1 - 1],2.0);
        wyy = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * pow(dxinv[2 - 1],2.0);
        wzz = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - \
1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + \
lo[3 - 1]) + 1) * (qw - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))])) * pow(dxinv[3 - 1],2.0);
        uxz = (ALP * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1])))]) + BET * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1])))]) + GAM * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng)\
 + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1])))]) + DEL * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1])))] - ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1])))])) * dxinv[3 - 1];
        vyz = (ALP * (vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1])))] - vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1])))]) + BET * (vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1])))] - vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1])))]) + GAM * (vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1])))] - vy[i - (-( *ng)\
 + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1])))]) + DEL * (vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1])))] - vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1])))])) * dxinv[3 - 1];
        difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))] =  *eta * (wxx + wyy + FourThirds * wzz + OneThird * (uxz + vyz));
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_diffterm_loop6) */
/* ! */
/* !    call build(bpt_diffterm_loop7, "bpt_diffterm_loop7") */
/*     !$OMP PARALLEL DO PRIVATE(i,j,k,txx,tyy,tzz) \ */
/*     !$OMP PRIVATE(divu,tauxx,tauyy,tauzz,tauxy,tauxz,tauyz,mechwork) */
  for (k = lo[3 - 1]; k <= hi[3 - 1]; k = k + 1) {
    for (j = lo[2 - 1]; j <= hi[2 - 1]; j = j + 1) {
      for (i = lo[1 - 1]; i <= hi[1 - 1]; i = i + 1) {
        txx = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + OFF1 * (q[i + 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - 1 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF2 * (q[i + 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1])\
 + 1) * (6 - 1)))] + q[i - 2 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF3 * (q[i + 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - 3 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF4 * (q[i + 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1\
]) + 1) * (6 - 1)))] + q[i - 4 - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))])) * pow(dxinv[1 - 1],2.0);
        tyy = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 1 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1])\
 + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 2 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 3 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j + 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1\
]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - 4 - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))])) * pow(dxinv[2 - 1],2.0);
        tzz = (CENTER * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + OFF1 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 1 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF2 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1])\
 + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 2 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF3 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 3 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))]) + OFF4 * (q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k + 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1\
]) + 1) * (6 - 1)))] + q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - 4 - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (6 - 1)))])) * pow(dxinv[3 - 1],2.0);
        divu = TwoThirds * (ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))]);
        tauxx = 2.e0 * ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - divu;
        tauyy = 2.e0 * vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - divu;
        tauzz = 2.e0 * wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] - divu;
        tauxy = uy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + vx[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))];
        tauxz = uz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + wx[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))];
        tauyz = vz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + wy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))];
        mechwork = tauxx * ux[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + tauyy * vy[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + tauzz * wz[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1])))] + pow(tauxy,2.0) + pow(tauxz,2.0) + pow(tauyz,2.0);
        mechwork =  *eta * mechwork + difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imx - 1)))] * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qu - 1)))] + difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imy - 1)))] * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qv - 1)))] + difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (imz - 1)))]\
 * q[i - (-( *ng) + lo[1 - 1]) + (hi[1 - 1] +  *ng - (-( *ng) + lo[1 - 1]) + 1) * (j - (-( *ng) + lo[2 - 1]) + (hi[2 - 1] +  *ng - (-( *ng) + lo[2 - 1]) + 1) * (k - (-( *ng) + lo[3 - 1]) + (hi[3 - 1] +  *ng - (-( *ng) + lo[3 - 1]) + 1) * (qw - 1)))];
        difflux[i - lo[1 - 1] + (hi[1 - 1] - lo[1 - 1] + 1) * (j - lo[2 - 1] + (hi[2 - 1] - lo[2 - 1] + 1) * (k - lo[3 - 1] + (hi[3 - 1] - lo[3 - 1] + 1) * (iene - 1)))] =  *alam * (txx + tyy + tzz) + mechwork;
      }
    }
  }
/*     !$OMP END PARALLEL DO */
/* !    call destroy(bpt_diffterm_loop7) */
/* ! */
/* !    call destroy(bpt_diffterm) */
}
/* !end module advance_module */
/* !end module advance_module */
