#!/usr/bin/bash
#
# (c) IBM Corporation 2008
#
# $Id: gnuplot-input.txt,v 1.1 2008-08-21 13:38:30 vj0 Exp $
#
# Script for generating plots from tables.
#
if [ $# -ne 3 ]
then
	printf "Usage: mk.plot.sh java.tbl c.tbl cilk.tbl\n"
	exit 1
fi
java_tbl=$1
c_tbl=$2
cilk_tbl=$3
out_file=`basename $java_tbl | sed -e 's;.tbl;;'`
tmp_file=/tmp/mk.plot.gnu.$$
set autoscale x
set autoscale y
set xtics 0,2,8
set ytics nomirror
set grid
set size 1,1
set style data linespoints
set terminal png
set output \"${out_file}.png\"
set ylabel \"MEdges/Sec\"
set xlabel \"Processes\"
set xrange [1:8]
set multiplot
set title \"BFS:Torus [Altair/500]\"
set origin 0,0.5
set size 0.5,0.5
plot "${java_tbl}" index 0 using 3:5 title "XWS-Adaptive BFS", "${c_tbl}" index 0 using 3:5 title "C-SpanT", "${cilk_tbl}" index 0 using 3:5 title "Cilk-BFSBlock"
set title "BFS:Torus [Altair/1000]"
set origin 0.5,0.5
set size 0.5,0.5
plot \"${java_tbl}\" index 1 using 3:5 title \"XWS-Adaptive BFS\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${c_tbl}\" index 1 using 3:5 title \"C-SpanT\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${cilk_tbl}\" index 1 using 3:5 title \"Cilk-BFSBlock\"" >> $tmp_file
printf "\n" >> $tmp_file
printf "set title \"BFS:Torus [Altair/2000]\"
set origin 0,0
set size 0.5,0.5
plot \"${java_tbl}\" index 2 using 3:5 title \"XWS-Adaptive BFS\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${c_tbl}\" index 2 using 3:5 title \"C-SpanT\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${cilk_tbl}\" index 2 using 3:5 title \"Cilk-BFSBlock\"" >> $tmp_file
printf "\n" >> $tmp_file
printf "set title \"BFS:Torus [Altair/3000]\"\n" >> $tmp_file
printf "set origin 0.5,0
printf "set size 0.5,0.5
printf "plot \"${java_tbl}\" index 3 using 3:5 title \"XWS-Adaptive BFS\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${c_tbl}\" index 3 using 3:5 title \"C-SpanT\", \\" >> $tmp_file
printf "\n" >> $tmp_file
printf "\"${cilk_tbl}\" index 3 using 3:5 title \"Cilk-BFSBlock\"" >> $tmp_file
 "\n" >> $tmp_file
unset multiplot

