/*
 *
 * (C) Copyright IBM Corporation 2006
 *
 *  This file is part of X10 Test.
 *
 */
import harness.x10Test;;

/**
 * Testing arrays that are nullable
 * (causes exception as of 3/12/05).
 *
 * @author kemal 3/2005
 */
public class NullableArray extends x10Test {

	public def run(): boolean = {
		var ia1: Array[int] = new Array[int](2);
		if (ia1(1) != 0) return false;
		var ia2: nullable<Array[int]> = null;
		if (ia2 != null) return false;
		var ia3: nullable<Array[int]> = null;
		if (ia3 != null) return false;
		ia3 = new Array[int](Dist.makeConstant([0..2], here));
		if (ia3(2) != 0) return false;
		var ia4: Array[mycomplex] = new Array[mycomplex](Dist.makeConstant([0..2], here), (var point [i]: point): mycomplex => { return new mycomplex(); });
		if (ia4(2).im != 0) return false;
		var ia5: nullable<Array[mycomplex]> = new Array[mycomplex](Dist.makeConstant([0..2], here), (var point [i]: point): mycomplex => { return new mycomplex(); });
		if (ia5(2).im != 0) return false;
		var ia7: nullable<Array[mycomplex]> = null;
		if (ia7 != null) return false;
		return true;
	}

	public static def main(var args: Rail[String]): void = {
		new NullableArray().execute();
	}

	static class mycomplex {
		var re: int;
		var im: int;
	}
}
