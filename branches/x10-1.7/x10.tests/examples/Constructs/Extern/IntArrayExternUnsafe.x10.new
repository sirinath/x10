/*
 *
 * (C) Copyright IBM Corporation 2006
 *
 *  This file is part of X10 Test.
 *
 */
import harness.x10Test;;

/**
 * Test to check that unsafe is being parsed correctly.
 */
public class IntArrayExternUnsafe extends x10Test {

	native public static def howdy(var yy: Array[int]): void;
	static { System.loadLibrary("IntArrayExternUnsafe"); }

	public def run(): boolean = {
		var high: int = 10;
		var verified: boolean = false;
		var d: dist = Dist.makeConstant([0..high], here);
		var y: Array[int] = new Array[int](d);

		for (var j: int = 0; j < 10; ++j) {
			y(j) = j;
		}

		howdy(y);

		for (var j: int = 0; j < 10; ++j) {
			var expected: int = j + 100;
			if (y(j) != expected) {
				System.out.println("y["+j+"] = "+y(j)+" != "+expected);
				return false;
			}
			//System.out.println("y["+j+"]:"+(y[j]));
		}
		return true;
	}

	public static def main(var args: Rail[String]): void = {
		new IntArrayExternUnsafe().execute();
	}
}
