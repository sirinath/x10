\documentclass[preprint,nocopyrightspace,9pt]{sigplanconf}
%\documentclass{llncs}

\newif\iflncs
\lncsfalse

\usepackage{times-lite}
\usepackage{mathptm}
\usepackage{txtt}
\usepackage{stmaryrd}
\usepackage{code}
\usepackage{bcprules}
%\usepackage{ttquot}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{afterpage}
\usepackage{balance}
\usepackage{floatflt}
\usepackage{defs}
\usepackage{utils}
\usepackage[pdftex]{graphicx}
\usepackage{xspace}
\usepackage{ifpdf}
\usepackage{listings}
\usepackage{x10}

\newif\ifsemantics
%\semanticsfalse
\semanticstrue

\hfuzz=1pt

\pagestyle{plain}


\ifpdf
\setlength{\pdfpagewidth}{8.5in}
\setlength{\pdfpageheight}{11in}
\fi

\newcommand\gxx{GFX\xspace}

\newcommand\xbar[1]{\ensuremath{\bar{\Xcd{#1}}}}
\newcommand\tbar[1]{\ensuremath{\bar{\tt {#1}}}}
\newcommand\exc[2]{\ensuremath{\exists}#1.~#2}
\newcommand\exty[3]{\ensuremath{\exists}#1\ty#2.~#3}
\newcommand\extyty[5]{\ensuremath{\exists}#1\ty#2,#3\ty#4.~#5}
\newcommand\extytyty[7]{\ensuremath{\exists}#1\ty#2,#3\ty#4,#5\ty#6.~#7}


% \input{../../../../vj/res/pagesizes}
% \input{../../../../vj/res/vijay-macros}
\newcommand\alt{\bnf}

\newcommand\Implies{\Rightarrow}

\iflncs
\else
\newtheorem{example}{Example}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newenvironment{proof}{
\trivlist
\item[\hskip \labelsep \textsc{Proof.}]
\selectfont
\ignorespaces}{$\Box$}

%\newtheorem{proof}[theorem]{Proof}
\fi

\begin{document}

\title{Genericity through Dependently Constrained Types}

\iflncs

\author{
Nathaniel Nystrom\inst{1}
\and
Igor Peshansky\inst{1}
\and
Vijay Saraswat\inst{1}
}

\institute{IBM T.~J. Watson Research~Center,
P.O.~Box~704, Yorktown~Heights NY 10598 USA,
\email{\{nystrom,igorp,vsaraswa\}@us.ibm.com}}

\else

\authorinfo{Nathaniel Nystrom\titlenote{IBM T.~J. Watson Research
Center, P.O. Box 704, Yorktown Heights NY 10598 USA}}{}
  {nystrom@us.ibm.com}
\authorinfo{Igor Peshansky$^{\;*}$}{}
  {igorp@us.ibm.com}
\authorinfo{Vijay Saraswat$^{\;*}$}{}
  {vsaraswa@us.ibm.com}

% \conferenceinfo{POPL'08}{XXX}
% \copyrightyear{2008}
% \copyrightdata{[to be supplied]}

\fi

\maketitle

\begin{abstract}
We present a general framework for \emph{generic constrained types}
that captures the notion of value-dependent and
type-dependent (generic) type systems for object-oriented
languages.  Constraint systems formalize systems of partial
information.  Constrained types are formulas \Xcd{C\{c\}} where
\Xcd{C} is the name of a class or an interface and \Xcd{c} is a
constraint on the immutable state of an instance of \Xcd{C} (the
{\em properties}).

The basic idea is to formalize the essence of nominal
object-oriented types as a constraint system, and to permit both
value and type properties and parameters.  Type-generic
dependence is now expressed through constraints on these
properties and parameters.  Type-valued properties are required
to have a run-time representation---the run-time semantics is
not defined through erasure.

Many type systems for object-oriented languages developed over
the last decade can be thought of as constrained type systems in
this formulation.  This framework is parametrized by an
arbitrary constraint system $\cal C$ of interest.  It permits
the development of languages with pluggable type systems, and
supports dynamic code generation to check casts at run-time.

The paper makes the following contributions: (1) We show how to
accommodate generic object-oriented types within the framework of
constrained types. (1) We illustrate the type system with the
development of a formal calculus \gxx and establish type
soundness. (3) We discuss the design and implementation of the
type system for X10, a modern object-oriented language, based on
constrained types.  The type system integrates and extends the
features of nominal types, virtual types, and
Scala's path-dependent types, as well as representing generic
types.
\end{abstract}

\section{Introduction}
\label{sec:intro}
\input{introduction}

\section{X10 language overview}
\label{sec:lang}
\input{x10-overview}

\section{Semantics}
\label{sec:semantics}
\input{semantics.tex}

\eat{\input{constraint-solver.tex}}

\section{Translation}
\label{sec:translation}
\input{translation.tex}

\section{Discussion}
\label{sec:discussion}
\input{discussion}

\section{Related work}
\label{sec:related}
\input{related}

\section{Conclusions}
\label{sec:conclusions}

We have presented a preliminary design for supporting genericity
in X10 using type properties.  This type system generalizes the
existing X10 type system.  The use of constraints on type
properties allows
the design to capture many features of generics in languages
like Java 5 and C\# and then to extend these features with new
more expressive power.
We expect that the design admits an efficient
implementation and intend to implement the design shortly.

\section*{Acknowledgments} 

The authors thank Bob Blainey, 
Doug Lea, Jens Palsberg, Lex Spoon, and Olivier Tardieu
for valuable feedback on versions of the language.
We thank 
Andrew Myers and
Michael Clarkson for providing us with their implementation of
PolyJ, on which our implementation was based, and for many
discussions over the years about parametrized types in Java.

\bibliographystyle{plain}
\bibliography{master}

% \appendix
% \onecolumn

% \section{An extended example}
% \input{longex}

\end{document}
